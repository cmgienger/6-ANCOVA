---
title: "Chapter 6 Analysis of Covariance (ANCOVA)"
author: "BIOL 5000"
output:
  html_document:
    df_print: paged
  html_notebook:
    df_print: paged
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(HH)
library(dplyr)
library(ggplot2)
library(ggfortify)
```

```{r cars}
#import and view data
limp <- read.csv("limpet.csv")
View(limp)
```

```{r glimpse the data}
glimpse(limp)
```

```{r visualize}
#as always, we make a plot to visualize data
ggplot(limp, aes(x = DENSITY, y = EGGS, colour = SEASON)) +
  geom_point() +
  scale_color_manual(values = c(spring="green", summer="red")) +
  theme_bw()
```

Can also use the 'ancovaplot' function in the HH package to plot and fit lines
```{r ancova plot function-1}
ancovaplot(EGGS ~ DENSITY + SEASON, data=limp) #equal slopes plot
```

```{r ancova plot function-2}
ancovaplot(EGGS ~ DENSITY * SEASON, data=limp) #separate slopes plot
```

```{r specify model that includes interaction}
#specify the ANCOVA model
limp.mod <- lm(EGGS ~ DENSITY * SEASON, data = limp)

#details about the model
names(limp.mod)
```

```{r check model assumptions}
#check model assumptions
autoplot(limp.mod, smooth.colour = NA)
```

```{r interpret the model}
#interpret the model
anova(limp.mod)
summary(limp.mod)
```

```{r specify model without interaction}
#fit model WITHOUT interaction (since we remove N.S. interaction terms)
limp.mod.nointeraction <- lm(EGGS ~ DENSITY + SEASON, data = limp)
anova(limp.mod.nointeraction)
summary(limp.mod.nointeraction)
```
Doesn't change much because slope and seasons were already significant; we are just re-assigning the '0.0118' variation from interaction back to the other model terms.

```{r compare models}
#compare the two models
anova(limp.mod, limp.mod.nointeraction)
```
P=0.79, so the two models do not have statistically different explanatory power. Likely because there really wasn't much difference in fit lines of the same slopes model vs. the separate slopes model. 
